{% extends "auction/auction_base.html" %}
{% load static %}
{% load poll_extras %}

{% block content %}
<script>
    var audioBuffer = null;
    window.AudioContext = window.AudioContext || window.webkitAudioContext;
    var audioContext = null;
    var source;

    function play(url) {
        if (audioContext == null) {
            audioContext = new AudioContext();
        }
        var request = new XMLHttpRequest();
        if (source) {
            try {
                source.stop();
            } catch (err) {}
        }
        source = audioContext.createBufferSource();
        source.connect(audioContext.destination);
        request.open('GET', url, true);
        request.responseType = 'arraybuffer';
        request.onload = function() {
            audioContext.decodeAudioData(request.response, function(buffer) {
                source.buffer = buffer;
                source.start(0);
            });
        }
        request.send();
    }
</script>

<h1>Список аукционов</h1>
{% for auction in auction_list %}
    <a href=""> <li>{{ auction.product.title }}</li></a>
    <li>{{ auction.product.description }}</li>
    <li>До конца аукциона:{{ auction.time_ending|delta_time}}</li>
{% endfor %}


<div style="height:100px" class="small-button" onmousedown=" play( '/static/sounds/stonks.mp3' ) "></div>
{% endblock %}